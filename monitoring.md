## Observability (более широкое понятие чем мониторинг)
---
  - Метрики
  - Логи
  - Трейсинг
  - Алертинг

### Метрики
  - Бизнес логика
  - Приложение
  - Runtime
  - OS
  - VM/контейнер
  - Виртуализация
  - Сеть
  - Железо

#### Методологии сбора
  - **USE** (Netflix, Brendann Greg)
    Utilization (Утилизация насколько загружен наш сервис)
    Saturation (Перегруженность, сколько система ждет пока в очереди находятся задания)
    Errors (Ошибки)
  - **RED** (Grafana)
    Rate (Кол-во запросов к сервису)
    Errors (Ошибки)
    Durations (Время обработки одного запроса)
  - **LTES** (Google SRE)
    Latency (Время обработки запроса)
    Traffic (Кол-во запросов)
    Errors (Ошибки)
    Saturations (Перегруз сервиса, кол-во отложенной работы)

#### Инструменты
  - Prometheus-stack
  - Zabbix
  - Nagios
  - Datadog
  - Cloud Monitoring

### Логи
---
#### Типы логов
  - неструктурированные
    [INFO] <date-time> <message>
  - полуструктурированные
    [INFO] <date-time> {field1: value, field2: value}
  - структурированные
    {ts: date-time, type: "info", message: value}

#### Анализ логов
  - создание метрик из логов (кол-во заказав в час, кол-во ошибок, логинов и т.д.)
  - прогнозирование поведения пользователей (при увеличении событий скейлим поды)
  - анализ системных логов (по ошибкам вебсервера понимаем что приложение не работает)

#### Инструменты
  - ELK / EFK
  - Loki / Promtail
  - Graylog
  - Cloud Logging 

### Трейсинг
---
#### Структура
  - трейсы (полное прохождение запроса)
  - сегменты (span) (время обработки конкрентым сервисом)
  - подсегменты (части трейса внутри сегмента)

#### Полезности трейсов
  - семплирование (покрывать трейсами только нужные части иначе все будет работать только на трейсы)
  - Service Mesh
  - генерация метрик из трейсов
  - выявление аномалий

#### Инструменты
  - Jaeger / Zipkin
  - Kiali
  - Cloud Trace

### Алертинг
---
#### Принципы
  - **SLI (Service level indicators)** - индикаторы (метрики - трейсы - логи)
  - **SLO (Service level objective)** - соглашение о целевом состоянии сервиса - алерты вешаем на этот параметр, он должен быть мешьше чем SLA. **Error budget** - бюджет ошибок
  - **SLA (Service level agreement)** - соглашение об уровне обслуживания - договор

#### Типы алертов
  - **Threshold** (пороговые - срабатывают при достижении порога)
  - **Trends** (трендовые - срабатывают при изменении динамики)

## Что мониторить
---
  - Health - check
  - Рестарты (много плохо - мало интересно!)
  - CPU / RAM (min / max / average)
  - Кол-во реплик (прогнозирование нагрузки, анализ аномалий)
  - Коммуникации между приложениями (мониторинг внешних сервисов, выявление задержек в ответах от сервиса)
  - CI/CD (кол-во сборок, длительность сборки, кол-во тестов успешных/заваленных)
  - Алерты в pipelines (успех/ неуспех сборки)
  - Security (новые открытые порты, уязвимости)
  - Мониторинг кол-во таргетов в прометее и кол-ва сервисов (должны совпадать)
  - Бизнес метрики (успешные / неуспешные операции, кол-во ошибок приложения)
  - Метрики на основе трейсов (время обработки транзакции)

#### Инструменты
  - Grafana Oncall
  - Okmeter
  - PagerDuty
  - ServiceNow
